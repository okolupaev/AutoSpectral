<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get Autofluorescence Spectra — get.af.spectra • AutoSpectral</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Autofluorescence Spectra — get.af.spectra"><meta name="description" content="Extracts autofluorescence spectra from an unstained samples. Intended for use
with unmix.autospectral. Uses FlowSOM (EmbedSOM) clustering for rapid
identification of cells with similar AF profiles."><meta property="og:description" content="Extracts autofluorescence spectra from an unstained samples. Intended for use
with unmix.autospectral. Uses FlowSOM (EmbedSOM) clustering for rapid
identification of cells with similar AF profiles."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AutoSpectral</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/01_Full_AutoSpectral_Workflow.html">01 Full Workflow Example</a></li>
    <li><a class="dropdown-item" href="../articles/02_Control_File_example.html">02 Creating the control file</a></li>
    <li><a class="dropdown-item" href="../articles/03_Aurora_example.html">03 Aurora AutoSpectral Example</a></li>
    <li><a class="dropdown-item" href="../articles/04_ID7000_WLS_example.html">04 ID7000 WLS Example</a></li>
    <li><a class="dropdown-item" href="../articles/05_Preparing_Controls.html">05 Preparing Controls</a></li>
    <li><a class="dropdown-item" href="../articles/06_Gating.html">06 Gating</a></li>
    <li><a class="dropdown-item" href="../articles/07_Cleaning.html">07 Control clean-up</a></li>
    <li><a class="dropdown-item" href="../articles/08_Single_Cell_AutoFluorescence.html">08 Single Cell Autofluorescence</a></li>
    <li><a class="dropdown-item" href="../articles/09_Per_Cell_Optimization.html">09 Per Cell Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/10_Reload_AutoSpectral.html">10 Re-running AutoSpectral</a></li>
    <li><a class="dropdown-item" href="../articles/11_Plotting.html">11 Plotting</a></li>
    <li><a class="dropdown-item" href="../articles/12_Speed_It_Up.html">12 Speed It Up (Why So Slow?)</a></li>
    <li><a class="dropdown-item" href="../articles/13_Updates_And_Issues.html">13 Updates and Issues</a></li>
    <li><a class="dropdown-item" href="../articles/14_Development.html">14 Development</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/DrCytometer/AutoSpectral/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get Autofluorescence Spectra</h1>
      <small class="dont-index">Source: <a href="https://github.com/DrCytometer/AutoSpectral/blob/HEAD/R/get_af_spectra.R" class="external-link"><code>R/get_af_spectra.R</code></a></small>
      <div class="d-none name"><code>get.af.spectra.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extracts autofluorescence spectra from an unstained samples. Intended for use
with <code>unmix.autospectral</code>. Uses FlowSOM (EmbedSOM) clustering for rapid
identification of cells with similar AF profiles.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get.af.spectra</span><span class="op">(</span></span>
<span>  <span class="va">unstained.sample</span>,</span>
<span>  <span class="va">asp</span>,</span>
<span>  <span class="va">spectra</span>,</span>
<span>  som.dim <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  figures <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot.dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  table.dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Autofluorescence spectra"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  refine <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  problem.quantile <span class="op">=</span> <span class="fl">0.99</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-unstained-sample">unstained.sample<a class="anchor" aria-label="anchor" href="#arg-unstained-sample"></a></dt>
<dd><p>Path and file name for a unstained sample FCS file.
The sample type and processing (protocol) method should match the fully
stained samples to which the AF will be applied, ideally.</p></dd>


<dt id="arg-asp">asp<a class="anchor" aria-label="anchor" href="#arg-asp"></a></dt>
<dd><p>The AutoSpectral parameter list.</p></dd>


<dt id="arg-spectra">spectra<a class="anchor" aria-label="anchor" href="#arg-spectra"></a></dt>
<dd><p>Spectral signatures of fluorophores, normalized between 0
and 1, with fluorophores in rows and detectors in columns.</p></dd>


<dt id="arg-som-dim">som.dim<a class="anchor" aria-label="anchor" href="#arg-som-dim"></a></dt>
<dd><p>Number of x and y dimensions for the SOM. Default is <code>10</code>.</p></dd>


<dt id="arg-figures">figures<a class="anchor" aria-label="anchor" href="#arg-figures"></a></dt>
<dd><p>Logical, whether to plot the spectral traces and heatmap for
the AF signatures. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-plot-dir">plot.dir<a class="anchor" aria-label="anchor" href="#arg-plot-dir"></a></dt>
<dd><p>Directory (folder) where the plots will be saved. Default is
<code>NULL</code>, which inherits from <code>asp$figure.af.dir</code>.</p></dd>


<dt id="arg-table-dir">table.dir<a class="anchor" aria-label="anchor" href="#arg-table-dir"></a></dt>
<dd><p>Directory (folder) where the spectra csv file will be saved.
Default is <code>NULL</code>, which inherits from <code>asp$table.af.dir</code>.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>Title for the output spectral plots and csv file. Default is
<code>Autofluorescence spectra</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical, controls messaging. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-refine">refine<a class="anchor" aria-label="anchor" href="#arg-refine"></a></dt>
<dd><p>Logical, default is <code>FALSE</code>. Controls whether to perform a second
round of autofluorescence measurement on "problem cells", which are those
with the highest spillover, as defined by <code>problem.quantile</code>. When <code>FALSE</code>,
behavior is identical to versions of AutoSpectral prior to 1.0.0. If you are
working with samples containing complex autofluorescence, e.g., tissues or
tumors, using <code>refine=TRUE</code> will improve autofluorescence extraction in the
unmixing at the cost of an increase in unmixing time. The increase in time
will depend on the method used to assign autofluorescence spectra per cell
(residual based assignment is very fast) and whether you have installed
<code>AutoSpectralRcpp</code>, which will speed up assignment and unmixing.</p></dd>


<dt id="arg-problem-quantile">problem.quantile<a class="anchor" aria-label="anchor" href="#arg-problem-quantile"></a></dt>
<dd><p>Numeric, default <code>0.99</code>. The quantile for determining
which cells will be considered "problematic" after unmixing with per-cell AF
extraction. Cells in the <code>problem.quantile</code> or above with respect to total
signal in the fluorophore (non-AF) channels after per-cell AF extraction will
be used to determine additional autofluorescence spectra, using a second round
of clustering and modulation of the previously selected autofluorescence
spectra. A value of <code>0.99</code> means the top 1% of cells, those farthest from zero,
will be selected for further investigation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A matrix of autofluorescence spectra.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Oliver Burton, Adrian Liston.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

