<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>13 Updates and Issues • AutoSpectral</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="13 Updates and Issues">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AutoSpectral</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/01_Full_AutoSpectral_Workflow.html">01 Full Workflow Example</a></li>
    <li><a class="dropdown-item" href="../articles/02_Control_File_example.html">02 Creating the control file</a></li>
    <li><a class="dropdown-item" href="../articles/03_Aurora_example.html">03 Aurora AutoSpectral Example</a></li>
    <li><a class="dropdown-item" href="../articles/04_ID7000_WLS_example.html">04 ID7000 WLS Example</a></li>
    <li><a class="dropdown-item" href="../articles/05_Preparing_Controls.html">05 Preparing Controls</a></li>
    <li><a class="dropdown-item" href="../articles/06_Gating.html">06 Gating</a></li>
    <li><a class="dropdown-item" href="../articles/07_Cleaning.html">07 Control clean-up</a></li>
    <li><a class="dropdown-item" href="../articles/08_Single_Cell_AutoFluorescence.html">08 Single Cell Autofluorescence</a></li>
    <li><a class="dropdown-item" href="../articles/09_Per_Cell_Optimization.html">09 Per Cell Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/10_Reload_AutoSpectral.html">10 Re-running AutoSpectral</a></li>
    <li><a class="dropdown-item" href="../articles/11_Plotting.html">11 Plotting</a></li>
    <li><a class="dropdown-item" href="../articles/12_Speed_It_Up.html">12 Speed It Up (Why So Slow?)</a></li>
    <li><a class="dropdown-item" href="../articles/13_Updates_And_Issues.html">13 Updates and Issues</a></li>
    <li><a class="dropdown-item" href="../articles/14_Development.html">14 Development</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DrCytometer/AutoSpectral/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>13 Updates and Issues</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DrCytometer/AutoSpectral/blob/HEAD/vignettes/articles/13_Updates_And_Issues.Rmd" class="external-link"><code>vignettes/articles/13_Updates_And_Issues.Rmd</code></a></small>
      <div class="d-none name"><code>13_Updates_And_Issues.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="updates-and-news">Updates and news<a class="anchor" aria-label="anchor" href="#updates-and-news"></a>
</h2>
<ul>
<li><p>Version 0.8.1: More fluorophores, rearranging detectors if
needed</p></li>
<li><p>Version 0.8.2: Support for Mosaic and Xenith cytometers</p></li>
<li><p>Version 0.8.3: Patch for error introduced in 0.8.2</p></li>
<li><p>Version 0.8.4: Changes to error messaging in
check.control.file</p></li>
<li><p>Version 0.8.5: Improvements to keyword handling in writing FCS
files</p></li>
<li><p>Version 0.8.6: Improvements to plotting, fluorophore
matching</p></li>
<li><p>Version 0.8.7: Support for Symphony A5 SE and Cytek Northern
Lights. More improvements to plotting. Marker names will now be added to
the control file based on matches in the FCS file names, where possible.
The Hotspot(TM) matrix will be calculated and plotted as per the <a href="https://www.biorxiv.org/content/10.1101/2025.04.17.649396v2.full.pdf" class="external-link">preprint</a>
by Peter Mage et al.</p></li>
<li>
<p>Version 0.9.0:</p>
<ul>
<li>Changes to <code>get.spectral.variants</code>, including fixing of
previously user-modifiable parameters, low-level denoising of spectra
and a bug patch for situations with beads using internal negatives.</li>
<li>More checks in <code>check.control.file</code>.</li>
<li>New parallel backend.</li>
<li>Faster AutoSpectral unmixing in base R.</li>
<li>Adjustments to reduce any discontinuities produced during
unmixing.</li>
<li>See also updates in <code>AutoSpectralRcpp</code>, including a large
speed up and general improvement to the Poisson IRLS unmixing.</li>
<li>Patch to <code>reload.flow.control</code> bug affecting ID7000
samples.</li>
<li>Patch to <code><a href="../reference/define.flow.control.html">define.flow.control()</a></code> affecting universal
negative definitions and impacting on
<code><a href="../reference/clean.controls.html">clean.controls()</a></code>.</li>
<li>Calculation of the unmixing matrix (Moore-Penrose pseudoinverse)
will now be done using singular value decomposition <code><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd()</a></code>
for numerical stability for all approaches. Up to now, it has been done
with normal equations via <code><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve()</a></code>. This should be better in
edge cases. In most cases, the only difference will be floating point
error. Calculation time is equivalent because almost all of the
computational effort is on projecting the raw data into the unmixed
space via the unmixing matrix, not calculating the unmixing matrix.</li>
<li>New functions to <code>save.unmixing.matrix</code> and
<code>calculate.weights</code>
</li>
<li>Patches to <code>define.flow.control</code> that were causing
redundant gates to be created.</li>
<li>Code legibility formatting.</li>
</ul>
</li>
<li><p>Version 0.9.1:</p></li>
<li><p>Switch to <code><a href="https://rdrr.io/pkg/FlowSOM/man/SOM.html" class="external-link">FlowSOM::SOM()</a></code> from
<code><a href="https://rdrr.io/pkg/EmbedSOM/man/SOM.html" class="external-link">EmbedSOM::SOM()</a></code>.</p></li>
<li><p>Patch to appending “-A” suffix to parameter names.</p></li>
<li><p>Version 0.9.2:</p></li>
<li><p>Faster base R per-cell optimization.</p></li>
<li><p>Patch to writing of “-A” in the channel names of FCS
files.</p></li>
<li><p>Version 1.0.0:</p></li>
<li><p>Changes to <code><a href="../reference/unmix.autospectral.html">unmix.autospectral()</a></code> to speed up
processing and reduce discontinuities in the resulting unmixed
data.</p></li>
<li><p>Version 1.0.0 brings a revamp to how AutoSpectral identifies the
best spectra on a per-cell basis. The theory behind it remains the
same–we are still trying to identify the variation in the
autofluorescence and fluorophores that best reduces the residual on a
per-cell basis. Now, however, we do not need to do that using brute
force. Instead, we can search only through variants (or
autofluorescences) that align with a given cell’s residual. Thus we can
pre-screen the variants to a select few and then test just those. This
means we can figure out the solution in way less time. It also means
that a native R implementation of the algorithm is possible in R in a
somewhat reasonable time frame. So, that may help for anyone struggling
to use the fast C++ version in <code>AutoSpectralRcpp</code>. Specifics
on this will be detailed in an article on GitHub and Colibri
Cytometry.</p></li>
<li><p>Since we can now quickly identify which variants are useful for a
given cell, we can test more variants, allowing a finer-grained view of
the variation, which may improve unmixing quality.</p></li>
<li><p>Autofluorescence extraction and fluorophore variation extraction
are now modified to search for more variation, focusing on “problematic”
cells that remain far from where they should be when the first batch of
variation is applied. This is most helpful for extracting
autofluorescence in complex tissue samples, where AutoSpectral
previously struggled to deal with the last few messy cells.</p></li>
<li><p>Speed in unmixing should be the biggest change, particularly if
you run using <code>AutoSpectralRcpp</code>.</p></li>
<li><p>When extracting autofluorescence using
<code><a href="../reference/get.af.spectra.html">get.af.spectra()</a></code>, you will now get a set of plots showing
you the unmixed data for the channels most affected by the
autofluorescence (“worst channels”). The same channels will be plotted
after a single round of autofluorescence extraction per cell (as in
AutoSpectral v0.9.2 and earlier) as well as after the second round,
using data from more difficult cells. To see this, run with
<code>refine = TRUE</code>, which is the default setting now.</p></li>
<li><p>Autofluorescence is now assigned to each cell using a shortcut to
“project” where the AF will impact on fluorophore or residual space.
This is especially fast for residual-based assignment.</p></li>
<li><p>Perhaps most importantly, discontinuities that sometimes appeared
in the data after unmixing using per-cell-fluorophore optimization,
particularly with the “fast” approximation, should now be gone or at
least greatly diminished.</p></li>
<li><p>Another change to the base unmixing functions to provide a
speed-up when unmixing in a per-cell loop. When performing standard OLS
or WLS unmixing outside of per-cell optimization, singular value
decomposition will still be used to calculate the unmixing
matrix.</p></li>
</ul>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Oliver Burton, Adrian Liston.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
